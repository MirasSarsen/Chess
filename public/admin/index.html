<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8" />
    <title>–†–µ–¥–∞–∫—Ç–æ—Ä –ì–ª–∞–≤–Ω–æ–π</title>
    <link rel="stylesheet" href="/admin/styles.css" />
    <style>
        /* –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ */

        .admin-nav {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .admin-link {
            background: #0077cc;
            color: #fff;
            padding: 10px 18px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: bold;
            transition: background 0.3s;
        }

        .admin-link:hover {
            background: #005fa3;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #f1f1f1;
            color: #333;
            padding: 40px;
            margin: 0;
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #222;
        }

        form {
            background: #fff;
            max-width: 800px;
            margin: 0 auto;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        h2 {
            margin-top: 30px;
            color: #2c3e50;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
        }

        input,
        textarea {
            width: 100%;
            padding: 12px;
            margin: 10px 0 20px;
            font-size: 1rem;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-sizing: border-box;
        }

        button {
            padding: 12px 24px;
            background: #00cc44;
            color: white;
            font-size: 1.1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.3s;
        }

        button:hover {
            background: #009933;
        }

        .section-group {
            margin-bottom: 40px;
        }

        .feature-block {
            border: 1px dashed #ccc;
            padding: 10px 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            background: #f9f9f9;
        }

        .feature-block input {
            margin-bottom: 10px;
        }
    </style>
</head>


<body>
    <div class="admin-nav">
        <a href="/admin/index.html" class="admin-link">–†–µ–¥–∞–∫—Ç–æ—Ä –ì–ª–∞–≤–Ω–æ–π</a>
        <a href="/admin/schedule.html" class="admin-link">–†–µ–¥–∞–∫—Ç–æ—Ä –†–∞—Å–ø–∏—Å–∞–Ω–∏—è</a>
        <a href="/admin/students.html" class="admin-link">–†–µ–¥–∞–∫—Ç–æ—Ä –£—á–µ–Ω–∏–∫–æ–≤</a>
        <a href="/admin/tournaments.html" class="admin-link">–†–µ–¥–∞–∫—Ç–æ—Ä –¢—É—Ä–Ω–∏—Ä–æ–≤</a>
        <!-- —Å—é–¥–∞ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä—ã -->
    </div>
    <h1>–†–µ–¥–∞–∫—Ç–æ—Ä –ì–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã</h1>
    <form id="homeForm">
        <h2>Hero</h2>
        <input name="hero.title" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫" /><br />
        <input name="hero.subtitle" placeholder="–ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫" /><br />

        <h2>Features</h2>
        <div id="features">
            <!-- –∑–∞–ø–æ–ª–Ω–∏–º —á–µ—Ä–µ–∑ JS -->
        </div>

        <h2>–§—É—Ç–µ—Ä</h2>
        <input name="footer.aboutDesc" placeholder="–û –Ω–∞—Å" /><br />
        <input name="footer.phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" /><br />

        <button type="submit">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </form>

    <script>
        const form = document.getElementById("homeForm");
        const featuresDiv = document.getElementById("features");

        function setValue(path, value) {
            const input = form.querySelector(`[name="${path}"]`);
            if (input) input.value = value;
        }

        function getNestedValue(obj, path) {
            return path.split(".").reduce((o, key) => o?.[key], obj);
        }

        async function loadContent() {
            const res = await fetch("/api/content/home");
            const data = await res.json();

            setValue("hero.title", data.hero.title);
            setValue("hero.subtitle", data.hero.subtitle);
            setValue("footer.aboutDesc", data.footer.aboutDesc);
            setValue("footer.phone", data.footer.phone);

            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è feature-–±–ª–æ–∫–æ–≤
            featuresDiv.innerHTML = "";
            data.features.forEach((feature, i) => {
                const titleName = `features.${i}.title`;
                const descName = `features.${i}.desc`;
                featuresDiv.innerHTML += `
                <div class="feature-block">
                    <input name="${titleName}" placeholder="–§–∏—á–∞ ${i + 1} ‚Äî –ó–∞–≥–æ–ª–æ–≤–æ–∫" value="${feature.title}" />
                    <input name="${descName}" placeholder="–§–∏—á–∞ ${i + 1} ‚Äî –û–ø–∏—Å–∞–Ω–∏–µ" value="${feature.desc}" />
                </div>
                `;
            });
        }

        form.addEventListener("submit", async (e) => {
            e.preventDefault();
            const formData = new FormData(form);
            const data = {
                hero: {
                    title: formData.get("hero.title"),
                    subtitle: formData.get("hero.subtitle")
                },
                features: [0, 1, 2].map(i => ({
                    title: formData.get(`features.${i}.title`),
                    desc: formData.get(`features.${i}.desc`)
                })),
                footer: {
                    aboutDesc: formData.get("footer.aboutDesc"),
                    phone: formData.get("footer.phone")
                }
            };

            await fetch("/api/content/home", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(data)
            });
            alert("–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ!");
        });

        loadContent();
    </script>
</body>

</html>
